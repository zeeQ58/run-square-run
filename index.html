<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Run Square Run - Mobile</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;900&family=Inter:wght@400;900&display=swap');
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
            -webkit-user-select: none;
            user-select: none;
        }
        
        html, body {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: #020617;
            font-family: 'Inter', sans-serif;
            touch-action: none;
        }
        
        body {
            position: fixed;
            width: 100vw;
            height: 100vh;
            top: 0;
            left: 0;
        }
        
        canvas {
            display: block;
            width: 100vw;
            height: 100vh;
            position: absolute;
            top: 0;
            left: 0;
            z-index: 1;
        }
        
        .ui-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            color: white;
            z-index: 100;
            text-align: center;
            transition: all 0.4s cubic-bezier(0.4, 0, 0.2, 1);
            padding: 20px;
        }

        .bg-blur {
            background: radial-gradient(circle, rgba(15, 23, 42, 0.95) 0%, rgba(2, 6, 23, 1) 100%);
            backdrop-filter: blur(15px);
            -webkit-backdrop-filter: blur(15px);
        }

        .animate-title {
            font-family: 'Orbitron', sans-serif;
            animation: titlePulse 2s infinite ease-in-out;
            text-shadow: 0 0 20px rgba(99, 102, 241, 0.8);
        }

        @keyframes titlePulse {
            0%, 100% { transform: scale(1); filter: brightness(1); }
            50% { transform: scale(1.05); filter: brightness(1.3); text-shadow: 0 0 40px rgba(99, 102, 241, 1); }
        }

        .btn {
            background: linear-gradient(135deg, #6366f1 0%, #312e81 100%);
            color: white;
            padding: 18px 32px;
            border-radius: 12px;
            font-weight: 900;
            cursor: pointer;
            border: 3px solid #4f46e5;
            transition: all 0.2s ease;
            box-shadow: 0 0 25px rgba(99, 102, 241, 0.4);
            text-transform: uppercase;
            letter-spacing: 2px;
            margin: 10px;
            min-width: 280px;
            width: 90%;
            max-width: 300px;
            position: relative;
            overflow: hidden;
            font-size: 18px;
        }
        
        .btn:active {
            transform: translateY(2px);
            box-shadow: 0 0 15px rgba(99, 102, 241, 0.3);
        }
        
        .btn-secondary { 
            background: #1e293b; 
            border-color: #334155; 
        }
        
        .btn-danger { 
            background: linear-gradient(135deg, #ef4444 0%, #7f1d1d 100%); 
            border-color: #b91c1c; 
        }

        /* HUD iÃ§in mobil dÃ¼zenlemeler */
        .hud-container {
            position: fixed;
            color: white;
            display: flex;
            flex-direction: column;
            gap: 6px;
            pointer-events: none;
            z-index: 20;
            padding: 15px;
        }
        
        #hud1 { 
            top: 10px; 
            left: 10px; 
        }
        
        #hud2 { 
            top: 10px; 
            right: 10px; 
            align-items: flex-end; 
            text-align: right; 
        }

        .health-bar { 
            width: 180px; 
            height: 12px; 
            background: rgba(15, 23, 42, 0.9); 
            border: 2px solid #334155; 
            border-radius: 15px; 
            overflow: hidden; 
        }
        
        .health-fill { 
            width: 100%; 
            height: 100%; 
            transition: width 0.3s cubic-bezier(0.1, 0.9, 0.2, 1); 
        }
        
        #healthFill1 { 
            background: linear-gradient(90deg, #ef4444, #991b1b); 
        }
        
        #healthFill2 { 
            background: linear-gradient(90deg, #22c55e, #14532d); 
        }
        
        .score-text {
            font-size: 28px !important;
            font-weight: 900;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .shop-panel, .selection-panel {
            background: rgba(15, 23, 42, 0.98);
            border: 3px solid #4f46e5;
            padding: 25px;
            border-radius: 20px;
            display: none;
            flex-direction: column;
            gap: 20px;
            width: 95%;
            max-width: 400px;
            max-height: 85vh;
            overflow-y: auto;
            box-shadow: 0 0 100px rgba(0,0,0,0.9);
            position: relative;
        }

        .item-card {
            background: #1e293b;
            border: 2px solid #334155;
            padding: 15px;
            border-radius: 12px;
            display: flex;
            justify-content: space-between;
            align-items: center;
            transition: all 0.2s;
        }
        
        .item-card:active { 
            border-color: #6366f1; 
            background: #233149; 
        }

        #comboContainer {
            position: fixed;
            bottom: 100px;
            right: 20px;
            color: #818cf8;
            font-weight: 900;
            font-style: italic;
            text-align: right;
            pointer-events: none;
            transition: 0.2s;
            transform-origin: bottom right;
            z-index: 20;
        }

        .fireball-count { 
            display: flex; 
            gap: 4px; 
            margin-top: 5px; 
        }
        
        .fireball-dot { 
            width: 12px; 
            height: 12px; 
            border-radius: 50%; 
            background: #f97316; 
            box-shadow: 0 0 10px #f97316; 
        }
        
        .fireball-dot-p2 { 
            background: #22c55e; 
            box-shadow: 0 0 10px #22c55e; 
        }

        .currency-display { 
            color: #fbbf24; 
            font-weight: 900; 
            text-shadow: 0 0 10px rgba(251, 191, 36, 0.5); 
            font-size: 24px;
            margin-bottom: 20px;
        }
        
        #waveInfo {
            position: fixed;
            bottom: 100px;
            left: 20px;
            color: #818cf8;
            z-index: 20;
            text-shadow: 0 2px 10px rgba(0,0,0,0.5);
        }
        
        .wave-display {
            font-size: 36px !important;
            font-weight: 900;
        }
        
        .announcement {
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            font-size: 48px;
            font-weight: 900;
            color: white;
            pointer-events: none;
            text-shadow: 0 0 30px rgba(99, 102, 241, 0.8);
            opacity: 0;
            transition: 0.5s;
            text-align: center;
            width: 90%;
            z-index: 50;
        }

        /* === MOBÄ°L KONTROLLER === */
        #joyBase {
            position: fixed;
            left: 25px;
            bottom: 25px;
            width: 150px;
            height: 150px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.15);
            z-index: 30;
            display: none;
            border: 3px solid rgba(255, 255, 255, 0.3);
            box-shadow: 0 0 30px rgba(0, 0, 0, 0.3);
            touch-action: manipulation;
        }
        
        #joyStick {
            position: absolute;
            left: 50%;
            top: 50%;
            width: 70px;
            height: 70px;
            margin: -35px;
            border-radius: 50%;
            background: rgba(255, 255, 255, 0.8);
            box-shadow: 0 0 20px rgba(255, 255, 255, 0.3);
            transition: transform 0.1s ease;
        }

        #actionButtons {
            position: fixed;
            right: 25px;
            bottom: 25px;
            display: none;
            flex-direction: column;
            gap: 25px;
            z-index: 30;
            touch-action: manipulation;
        }

        #dashBtn, #fireBtn {
            width: 100px;
            height: 100px;
            border-radius: 50%;
            border: none;
            font-weight: 900;
            font-size: 18px;
            background: linear-gradient(135deg, #6366f1 0%, #312e81 100%);
            color: white;
            box-shadow: 0 0 30px rgba(99, 102, 241, 0.4);
            text-shadow: 0 2px 5px rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.1s ease;
            touch-action: manipulation;
            -webkit-tap-highlight-color: transparent;
        }
        
        #dashBtn:active, #fireBtn:active {
            transform: scale(0.95);
            box-shadow: 0 0 20px rgba(99, 102, 241, 0.6);
        }
        
        #fireBtn {
            background: linear-gradient(135deg, #f97316 0%, #9a3412 100%);
            font-size: 32px;
            box-shadow: 0 0 30px rgba(249, 115, 22, 0.4);
        }

        /* Mobil cihaz kontrolÃ¼ */
        @media (max-width: 768px) {
            #joyBase, #actionButtons {
                display: flex !important;
            }
            
            .hud-container {
                top: 5px;
            }
            
            #hud1 {
                left: 5px;
            }
            
            #hud2 {
                right: 5px;
            }
            
            .health-bar {
                width: 160px;
                height: 10px;
            }
            
            .score-text {
                font-size: 24px !important;
            }
            
            .btn {
                padding: 16px 24px;
                min-width: 250px;
                font-size: 16px;
            }
            
            #comboContainer {
                bottom: 180px;
                right: 15px;
            }
            
            #waveInfo {
                bottom: 180px;
                left: 15px;
            }
            
            .wave-display {
                font-size: 28px !important;
            }
            
            .announcement {
                font-size: 36px;
            }
            
            #joyBase {
                width: 140px;
                height: 140px;
            }
            
            #dashBtn, #fireBtn {
                width: 90px;
                height: 90px;
                font-size: 16px;
            }
            
            #fireBtn {
                font-size: 28px;
            }
            
            .main-title {
                font-size: 48px !important;
                line-height: 1.1 !important;
            }
        }

        /* Ã‡ok kÃ¼Ã§Ã¼k ekranlar */
        @media (max-width: 380px) {
            #joyBase {
                width: 130px;
                height: 130px;
                left: 15px;
                bottom: 15px;
            }
            
            #actionButtons {
                right: 15px;
                bottom: 15px;
                gap: 20px;
            }
            
            #dashBtn, #fireBtn {
                width: 80px;
                height: 80px;
                font-size: 14px;
            }
            
            #fireBtn {
                font-size: 24px;
            }
            
            .health-bar {
                width: 140px;
            }
            
            .main-title {
                font-size: 42px !important;
            }
            
            .btn {
                min-width: 220px;
                padding: 14px 20px;
            }
        }

        /* Yatay mod iÃ§in */
        @media (orientation: landscape) and (max-height: 600px) {
            .hud-container {
                top: 2px;
            }
            
            .health-bar {
                width: 120px;
                height: 8px;
            }
            
            .score-text {
                font-size: 20px !important;
            }
            
            #joyBase {
                width: 120px;
                height: 120px;
                bottom: 15px;
                left: 15px;
            }
            
            #actionButtons {
                bottom: 15px;
                right: 15px;
                gap: 15px;
            }
            
            #dashBtn, #fireBtn {
                width: 70px;
                height: 70px;
                font-size: 12px;
            }
            
            #fireBtn {
                font-size: 20px;
            }
            
            #comboContainer {
                bottom: 90px;
            }
            
            #waveInfo {
                bottom: 90px;
            }
            
            .ui-overlay {
                padding: 10px;
            }
            
            .btn {
                padding: 12px 20px;
                min-width: 200px;
                margin: 5px;
            }
        }
        
        /* iOS Safari iÃ§in Ã¶zel ayarlar */
        @supports (-webkit-touch-callout: none) {
            #dashBtn, #fireBtn, #joyBase {
                cursor: pointer;
            }
            
            .btn {
                padding: 20px 32px;
            }
        }
        
        /* Ekran boyutlandÄ±rma iÃ§in */
        .fullscreen {
            width: 100vw !important;
            height: 100vh !important;
            position: fixed !important;
            top: 0 !important;
            left: 0 !important;
        }
    </style>
</head>
<body>
    <!-- Ana Ekran -->
    <div id="startScreen" class="ui-overlay bg-blur">
        <h1 id="mainTitle" class="main-title text-6xl md:text-8xl font-black mb-4 animate-title tracking-tighter text-white uppercase">RUN SQUARE RUN</h1>
        <p id="tagline" class="mb-8 text-indigo-400 font-bold uppercase tracking-[0.4em] text-xs">SONSUZ KARANLIKTA HAYATTA KAL</p>
        
        <div id="goldStats" class="mb-8 text-2xl currency-display">ALTIN: <span id="totalGold">0</span></div>

        <div id="mainMenuBtns" class="w-full flex flex-col items-center">
            <button id="playBtn" class="btn">OYNA</button>
            <button id="openShopBtn" class="btn btn-secondary">DÃœKKAN</button>
            <button id="settingsBtn" class="btn btn-secondary">AYARLAR</button>
        </div>

        <!-- Oyuncu SeÃ§imi -->
        <div id="selectionPanel" class="selection-panel">
            <h2 id="selectionTitle" class="text-2xl font-black italic mb-6 tracking-tighter uppercase">MOD SEÃ‡Ä°MÄ°</h2>
            <button id="start1P" class="btn">1 OYUNCU</button>
            <button id="start2P" class="btn">2 OYUNCU</button>
            <button id="backToMainFromSelect" class="mt-6 text-sm font-bold text-slate-500 active:text-white uppercase tracking-widest">Ä°PTAL</button>
        </div>

        <!-- DÃ¼kkan -->
        <div id="shopPanel" class="shop-panel">
            <h2 id="shopTitle" class="text-2xl font-black italic mb-4 tracking-tighter uppercase">CEPHANELÄ°K</h2>
            <div class="currency-display mb-6">BAKÄ°YE: <span id="shopGold">0</span>G</div>
            <div class="item-card">
                <div class="text-left">
                    <div class="font-bold text-orange-400 uppercase text-sm">ATEÅž TOPU [F / DEL]</div>
                    <div class="text-xs text-slate-400 mt-1">YÄ±kÄ±cÄ± bir patlama fÄ±rlatÄ±n</div>
                </div>
                <button id="buyFireball" class="bg-indigo-600 px-4 py-3 rounded-lg font-black text-xs active:bg-indigo-500 transition">500G</button>
            </div>
            <div class="item-card">
                <div class="text-left">
                    <div class="font-bold text-red-400 uppercase text-sm">MAX CAN +20</div>
                    <div class="text-xs text-slate-400 mt-1">Hayatta kalma oranÄ±nÄ± artÄ±r</div>
                </div>
                <button id="buyHealth" class="bg-indigo-600 px-4 py-3 rounded-lg font-black text-xs active:bg-indigo-500 transition">300G</button>
            </div>
            <button id="closeShopBtn" class="mt-6 text-sm font-bold text-slate-500 active:text-white uppercase tracking-widest">KAPAT</button>
        </div>

        <!-- Ayarlar -->
        <div id="settingsPanel" class="shop-panel">
            <h3 id="langTitle" class="text-xl font-black italic mb-6 uppercase">DÄ°L SEÃ‡Ä°MÄ°</h3>
            <div class="grid grid-cols-2 gap-3">
                <button class="lang-btn btn-secondary py-3 rounded-lg font-bold active:bg-slate-700" data-lang="en">ENGLISH</button>
                <button class="lang-btn btn-secondary py-3 rounded-lg font-bold active:bg-slate-700" data-lang="tr">TÃœRKÃ‡E</button>
                <button class="lang-btn btn-secondary py-3 rounded-lg font-bold active:bg-slate-700" data-lang="es">ESPAÃ‘OL</button>
                <button class="lang-btn btn-secondary py-3 rounded-lg font-bold active:bg-slate-700" data-lang="ru">Ð Ð£Ð¡Ð¡ÐšÐ˜Ð™</button>
            </div>
            <button id="backBtn" class="mt-6 text-sm font-bold text-slate-500 active:text-white uppercase tracking-widest">MENÃœYE DÃ–N</button>
        </div>
    </div>

    <!-- Duraklatma -->
    <div id="pauseScreen" class="ui-overlay bg-blur" style="display: none;">
        <h2 id="pauseTitle" class="text-5xl md:text-7xl font-black mb-6 italic tracking-tighter animate-title uppercase">DURAKLATILDI</h2>
        <button id="resumeBtn" class="btn uppercase">DEVAM ET</button>
        <button id="restartBtn" class="btn btn-secondary uppercase">YENÄ°DEN BAÅžLA</button>
    </div>

    <!-- HUD P1 -->
    <div id="hud1" class="hud-container">
        <div class="score-text font-black italic tracking-tighter mb-1 uppercase"><span id="p1ScoreLabel">SKOR</span>: <span id="scoreDisplay">0</span></div>
        <div class="health-bar"><div id="healthFill1" class="health-fill"></div></div>
        <div class="flex items-center gap-3 mt-1">
            <div id="statusInfo1" class="text-xs font-black uppercase text-indigo-500 tracking-widest">DASH: HAZIR</div>
            <div id="abilityHUD1" class="flex gap-1 items-center">
                <span class="text-xs font-black text-orange-500 mr-1">[F]</span>
                <div id="fireballIcons1" class="fireball-count"></div>
            </div>
        </div>
    </div>

    <!-- HUD P2 -->
    <div id="hud2" class="hud-container" style="display: none;">
        <div class="score-text font-black italic tracking-tighter mb-1 uppercase">P2 <span id="p2HealthLabel">CAN</span></div>
        <div class="health-bar"><div id="healthFill2" class="health-fill"></div></div>
        <div class="flex items-center gap-3 mt-1">
            <div id="statusInfo2" class="text-xs font-black uppercase text-green-500 tracking-widest">DASH: HAZIR</div>
            <div id="abilityHUD2" class="flex gap-1 items-center">
                <div id="fireballIcons2" class="fireball-count"></div>
                <span class="text-xs font-black text-green-500 ml-1">[DEL]</span>
            </div>
        </div>
    </div>

    <div id="comboContainer">
        <div id="comboCount" class="text-6xl md:text-8xl">0</div>
        <div id="comboLabel" class="text-sm uppercase tracking-widest">KOMBO</div>
    </div>

    <div id="waveInfo">
        <div id="waveLabel" class="text-xs font-bold uppercase tracking-widest opacity-60">DALGA DURUMU</div>
        <div class="wave-display font-black italic tracking-tighter" id="waveDisplay">DALGA 1</div>
    </div>

    <div id="announcer" class="announcement">YENÄ° DALGA</div>

    <canvas id="gameCanvas" class="fullscreen"></canvas>

    <!-- MOBÄ°L KONTROLLER -->
    <div id="joyBase">
        <div id="joyStick"></div>
    </div>

    <div id="actionButtons">
        <button id="dashBtn">DASH</button>
        <button id="fireBtn">ðŸ”¥</button>
    </div>

    <script>
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        
        // Ekran boyutunu ayarla
        function resizeCanvas() {
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;
            console.log('Canvas resized to:', canvas.width, 'x', canvas.height);
        }
        
        resizeCanvas();
        window.addEventListener('resize', resizeCanvas);
        window.addEventListener('orientationchange', () => {
            setTimeout(resizeCanvas, 100);
        });
        
        let totalGold = parseInt(localStorage.getItem('rsr_gold')) || 0;
        let ownedFireballs = parseInt(localStorage.getItem('rsr_fireballs')) || 0;
        let maxHealthBonus = parseInt(localStorage.getItem('rsr_hp_bonus')) || 0;

        const screens = {
            start: document.getElementById('startScreen'),
            pause: document.getElementById('pauseScreen'),
            settings: document.getElementById('settingsPanel'),
            shop: document.getElementById('shopPanel'),
            select: document.getElementById('selectionPanel'),
            menuBtns: document.getElementById('mainMenuBtns')
        };
        
        const labels = {
            score: "SKOR", wave: "DALGA DURUMU", combo: "KOMBO", tagline: "SONSUZ KARANLIKTA HAYATTA KAL",
            pause: "DURAKLATILDI", dashReady: "DASH: HAZIR", dashWait: "DASH: DOLUYOR",
            waveText: "DALGA", gameOver: "OYUN BÄ°TTÄ°", tryAgain: "TEKRAR DENE",
            p2Health: "CAN"
        };

        const translations = {
            en: { 
                play: "PLAY", selection: "MODE SELECT", p1: "1 PLAYER", p2: "2 PLAYERS", settings: "SETTINGS", 
                shop: "SHOP", cancel: "CANCEL", score: "SCORE", wave: "WAVE STATUS", combo: "COMBO", 
                tagline: "SURVIVE THE INFINITE DARKNESS", pause: "PAUSED", resume: "RESUME", 
                restart: "RESTART", back: "BACK TO MENU", dashR: "DASH: READY", dashC: "DASH: CHARGING", 
                waveTitle: "WAVE", over: "GAME OVER", tryAgain: "TRY AGAIN", pHealth: "HP", shopTitle: "ARMORY", langTitle: "LANGUAGE"
            },
            tr: { 
                play: "OYNA", selection: "MOD SEÃ‡Ä°MÄ°", p1: "1 OYUNCU", p2: "2 OYUNCU", settings: "AYARLAR", 
                shop: "DÃœKKAN", cancel: "Ä°PTAL", score: "SKOR", wave: "DALGA DURUMU", combo: "KOMBO", 
                tagline: "SONSUZ KARANLIKTA HAYATTA KAL", pause: "DURAKLATILDI", resume: "DEVAM ET", 
                restart: "YENÄ°DEN BAÅžLA", back: "MENÃœYE DÃ–N", dashR: "DASH: HAZIR", dashC: "DASH: DOLUYOR", 
                waveTitle: "DALGA", over: "OYUN BÄ°TTÄ°", tryAgain: "TEKRAR DENE", pHealth: "CAN", shopTitle: "CEPHANELÄ°K", langTitle: "DÄ°L SEÃ‡Ä°MÄ°"
            },
            es: { 
                play: "JUGAR", selection: "MODO", p1: "1 JUGADOR", p2: "2 JUGADORES", settings: "AJUSTES", 
                shop: "TIENDA", cancel: "CANCELAR", score: "PUNTOS", wave: "OLEADA", combo: "COMBO", 
                tagline: "SOBREVIVE EN LA OSCURIDAD", pause: "PAUSADO", resume: "CONTINUAR", 
                restart: "REINICIAR", back: "MENÃš", dashR: "DASH: LISTO", dashC: "DASH: CARGANDO", 
                waveTitle: "OLEADA", over: "FIN DEL JUEGO", tryAgain: "REINTENTAR", pHealth: "VIDA", shopTitle: "ARMERÃA", langTitle: "IDIOMA"
            },
            ru: { 
                play: "Ð˜Ð“Ð ÐÐ¢Ð¬", selection: "Ð’Ð«Ð‘ÐžÐ ", p1: "1 Ð˜Ð“Ð ÐžÐš", p2: "2 Ð˜Ð“Ð ÐžÐšÐ", settings: "ÐÐÐ¡Ð¢Ð ÐžÐ™ÐšÄ°", 
                shop: "ÐœÐÐ“ÐÐ—Ð˜Ð", cancel: "ÐžÐ¢ÐœÐ•ÐÐ", score: "Ð¡Ð§Ð•Ð¢", wave: "Ð¡Ð¢ÐÐ¢Ð£Ð¡ Ð’ÐžÐ›ÐÐ«", combo: "ÐšÐžÐœÐ‘Ðž", 
                tagline: "Ð’Ð«Ð–Ð˜Ð¢Ð¬ Ð’ Ð‘Ð•Ð¡ÐšÐžÐÐ•Ð§ÐÐžÐ™ Ð¢Ð•ÐœÐÐžÐ¢Ð•", pause: "ÐŸÐÐ£Ð—Ð", resume: "ÐŸÐ ÐžÐ”ÐžÐ›Ð–Ð˜Ð¢Ð¬", 
                restart: "Ð—ÐÐÐžÐ’Ðž", back: "Ð’ ÐœÐ•ÐÐ®", dashR: "Ð Ð«Ð’ÐžÐš: Ð“ÐžÐ¢ÐžÐ’", dashC: "Ð Ð«Ð’ÐžÐš: Ð—ÐÐ Ð¯Ð”", 
                waveTitle: "Ð’ÐžÐ›ÐÐ", over: "ÐšÐžÐÐ•Ð¦ Ð˜Ð“Ð Ð«", tryAgain: "Ð•Ð©Ð• Ð ÐÐ—", pHealth: "ÐžÐ—", shopTitle: "ÐÐ Ð¡Ð•ÐÐÐ›", langTitle: "Ð¯Ð—Ð«Ðš"
            }
        };

        let currentLang = 'tr';
        let isTwoPlayer = false;
        let isMobile = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent);

        function setLanguage(lang) {
            currentLang = lang;
            const t = translations[lang];
            if(!t) return;
            document.getElementById('playBtn').innerText = t.play;
            document.getElementById('selectionTitle').innerText = t.selection;
            document.getElementById('start1P').innerText = t.p1;
            document.getElementById('start2P').innerText = t.p2;
            document.getElementById('settingsBtn').innerText = t.settings;
            document.getElementById('openShopBtn').innerText = t.shop;
            document.getElementById('backToMainFromSelect').innerText = t.cancel;
            document.getElementById('waveLabel').innerText = t.wave;
            document.getElementById('comboLabel').innerText = t.combo;
            document.getElementById('tagline').innerText = t.tagline;
            document.getElementById('pauseTitle').innerText = t.pause;
            document.getElementById('resumeBtn').innerText = t.resume;
            document.getElementById('restartBtn').innerText = t.restart;
            document.getElementById('backBtn').innerText = t.back;
            document.getElementById('p1ScoreLabel').innerText = t.score;
            document.getElementById('p2HealthLabel').innerText = t.pHealth;
            document.getElementById('shopTitle').innerText = t.shopTitle;
            document.getElementById('langTitle').innerText = t.langTitle;
            document.getElementById('closeShopBtn').innerText = t.back;
            
            labels.dashReady = t.dashR;
            labels.dashWait = t.dashC;
            labels.waveText = t.waveTitle;
            labels.gameOver = t.over;
            labels.tryAgain = t.tryAgain;
        }

        const audioCtx = new (window.AudioContext || window.webkitAudioContext)();
        function playImpactSound(type) {
            if (audioCtx.state === 'suspended') audioCtx.resume();
            const osc = audioCtx.createOscillator();
            const gain = audioCtx.createGain();
            if (type === 'kill') {
                osc.type = 'sawtooth'; osc.frequency.setValueAtTime(100, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(10, audioCtx.currentTime + 0.2);
                gain.gain.setValueAtTime(0.3, audioCtx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.2);
            } else if (type === 'fireball') {
                osc.type = 'sine'; osc.frequency.setValueAtTime(400, audioCtx.currentTime);
                osc.frequency.exponentialRampToValueAtTime(50, audioCtx.currentTime + 0.5);
                gain.gain.setValueAtTime(0.4, audioCtx.currentTime); gain.gain.exponentialRampToValueAtTime(0.01, audioCtx.currentTime + 0.5);
            }
            osc.connect(gain); gain.connect(audioCtx.destination);
            osc.start(); osc.stop(audioCtx.currentTime + 0.5);
        }

        let gameState = 'START';
        let score = 0, wave = 1, combo = 0, comboTimer = 0;
        let frameCount = 0, enemies = [], projectiles = [], particles = [], bloodSplats = [], keys = {}, screenShake = 0, enemiesToSpawn = 0, waveActive = false, hitStop = 0;

        const players = [
            {
                id: 1, x: 0, y: 0, w: 40, h: 40, speed: 6.5, angle: 0, color: '#0f172a', headColor: '#fee2e2',
                isDashing: false, dashTimer: 0, dashCooldown: 0, dashSpeed: 30, dashDuration: 8,
                health: 100, maxHealth: 100, fireballs: 0, alive: true,
                capeNodes: Array(10).fill({x: 0, y: 0})
            },
            {
                id: 2, x: 0, y: 0, w: 40, h: 40, speed: 6.5, angle: 0, color: '#14532d', headColor: '#dcfce7',
                isDashing: false, dashTimer: 0, dashCooldown: 0, dashSpeed: 30, dashDuration: 8,
                health: 100, maxHealth: 100, fireballs: 0, alive: false,
                capeNodes: Array(10).fill({x: 0, y: 0})
            }
        ];

        function updateCurrencyUI() {
            document.getElementById('totalGold').innerText = totalGold;
            document.getElementById('shopGold').innerText = totalGold;
            localStorage.setItem('rsr_gold', totalGold);
            localStorage.setItem('rsr_fireballs', ownedFireballs);
            localStorage.setItem('rsr_hp_bonus', maxHealthBonus);
        }

        function updateAbilityHUD() {
            players.forEach(p => {
                const container = document.getElementById(`fireballIcons${p.id}`);
                if(!container) return;
                container.innerHTML = '';
                for(let i=0; i<p.fireballs; i++) {
                    const dot = document.createElement('div');
                    dot.className = p.id === 1 ? 'fireball-dot' : 'fireball-dot fireball-dot-p2';
                    container.appendChild(dot);
                }
            });
        }

        function initGame(multi) {
            isTwoPlayer = multi;
            score = 0; combo = 0; wave = 1;
            
            players[0].alive = true;
            players[0].health = players[0].maxHealth = 100 + maxHealthBonus;
            players[0].fireballs = ownedFireballs;
            players[0].x = canvas.width / 2 - (multi ? 50 : 0); 
            players[0].y = canvas.height / 2;
            players[0].capeNodes = Array(10).fill(0).map(() => ({x: players[0].x, y: players[0].y}));
            
            if(multi) {
                players[1].alive = true;
                players[1].health = players[1].maxHealth = 100 + maxHealthBonus;
                players[1].fireballs = ownedFireballs;
                players[1].x = canvas.width / 2 + 50; 
                players[1].y = canvas.height / 2;
                players[1].capeNodes = Array(10).fill(0).map(() => ({x: players[1].x, y: players[1].y}));
                document.getElementById('hud2').style.display = 'flex';
                document.getElementById('healthFill2').style.width = '100%';
            } else {
                players[1].alive = false;
                document.getElementById('hud2').style.display = 'none';
            }

            enemies = []; projectiles = []; particles = []; bloodSplats = [];
            document.getElementById('scoreDisplay').innerText = "0";
            document.getElementById('healthFill1').style.width = '100%';
            updateAbilityHUD();
            startWave();
            
            // Mobil kontrolleri gÃ¶ster
            if(isMobile) {
                document.getElementById('joyBase').style.display = 'flex';
                document.getElementById('actionButtons').style.display = 'flex';
            }
        }

        function startWave() {
            waveActive = true;
            enemiesToSpawn = 10 + (wave * 5);
            document.getElementById('waveDisplay').innerText = `${labels.waveText} ${wave}`;
            showAnnouncer(`${labels.waveText} ${wave}`);
            
            // Dalga baÅŸÄ± can yenileme ve dirilme
            players.forEach(p => {
                if(isTwoPlayer || p.id === 1) {
                    if (!p.alive) {
                        p.alive = true;
                        p.x = canvas.width / 2;
                        p.y = canvas.height / 2;
                        p.capeNodes = Array(10).fill(0).map(() => ({x: p.x, y: p.y}));
                    }
                    p.health = p.maxHealth;
                    document.getElementById(`healthFill${p.id}`).style.width = '100%';
                }
            });
        }

        function showAnnouncer(text) {
            const el = document.getElementById('announcer');
            el.innerText = text; el.style.opacity = "1"; el.style.transform = "translate(-50%, -50%) scale(1.2)";
            setTimeout(() => { el.style.opacity = "0"; el.style.transform = "translate(-50%, -50%) scale(0.8)"; }, 1200);
        }

        function launchFireball(p) {
            if (p.fireballs <= 0) return;
            p.fireballs--;
            updateAbilityHUD();
            playImpactSound('fireball');
            screenShake = 20;

            for(let i=0; i<8; i++) {
                const ang = (Math.PI * 2 / 8) * i;
                projectiles.push({
                    x: p.x, y: p.y,
                    vx: Math.cos(ang) * 12, vy: Math.sin(ang) * 12,
                    radius: 15, life: 100, type: 'fireball', owner: p.id
                });
            }
        }

        function update() {
            if (gameState !== 'PLAYING') return;
            if (hitStop > 0) { hitStop--; return; }

            frameCount++;
            if (screenShake > 0) screenShake *= 0.9;
            if (comboTimer > 0) {
                comboTimer--;
                if (comboTimer <= 0) { combo = 0; }
            }
            document.getElementById('comboCount').innerText = combo;
            document.getElementById('comboContainer').style.opacity = combo > 0 ? "1" : "0";
            
            // Enemy Spawning
            if (enemiesToSpawn > 0 && frameCount % Math.max(8, 45 - wave * 2) === 0) {
                enemiesToSpawn--;
                const edge = Math.floor(Math.random() * 4);
                let x, y;
                if (edge === 0) { x = Math.random() * canvas.width; y = -50; }
                else if (edge === 1) { x = canvas.width + 50; y = Math.random() * canvas.height; }
                else if (edge === 2) { x = Math.random() * canvas.width; y = canvas.height + 50; }
                else { x = -50; y = Math.random() * canvas.height; }
                enemies.push({ x, y, speed: 2 + (wave * 0.15), pulse: Math.random()*Math.PI });
            }

            if (enemiesToSpawn === 0 && enemies.length === 0 && waveActive) {
                waveActive = false; 
                wave++; 
                setTimeout(startWave, 2000);
            }

            // Movement
            players.forEach(p => {
                if(!p.alive) return;

                let mx = 0, my = 0;
                if(p.id === 1) {
                    if (keys['KeyW'] || keys['ArrowUp']) my -= 1; 
                    if (keys['KeyS'] || keys['ArrowDown']) my += 1;
                    if (keys['KeyA'] || keys['ArrowLeft']) mx -= 1; 
                    if (keys['KeyD'] || keys['ArrowRight']) mx += 1;
                    if (keys['Space'] && !p.isDashing && p.dashCooldown <= 0) {
                        p.isDashing = true; p.dashTimer = p.dashDuration; p.dashCooldown = 30;
                    }
                    if (keys['KeyF']) { launchFireball(p); keys['KeyF'] = false; }
                } else {
                    if (keys['ArrowUp']) my -= 1; if (keys['ArrowDown']) my += 1;
                    if (keys['ArrowLeft']) mx -= 1; if (keys['ArrowRight']) mx += 1;
                    if ((keys['Numpad0'] || keys['Digit0']) && !p.isDashing && p.dashCooldown <= 0) {
                        p.isDashing = true; p.dashTimer = p.dashDuration; p.dashCooldown = 30;
                    }
                    if (keys['Delete']) { launchFireball(p); keys['Delete'] = false; }
                }

                if (p.isDashing) {
                    p.x += Math.cos(p.angle) * p.dashSpeed; p.y += Math.sin(p.angle) * p.dashSpeed;
                    p.dashTimer--;
                    if (p.dashTimer <= 0) p.isDashing = false;
                } else {
                    p.x += mx * p.speed; p.y += my * p.speed;
                    if (mx !== 0 || my !== 0) p.angle = Math.atan2(my, mx);
                    if (p.dashCooldown > 0) p.dashCooldown--;
                }
                document.getElementById(`statusInfo${p.id}`).innerText = p.dashCooldown <= 0 ? labels.dashReady : labels.dashWait;
                
                // Ekran sÄ±nÄ±rlarÄ± (mobile iÃ§in biraz iÃ§eride)
                const margin = 20;
                p.x = Math.max(margin, Math.min(canvas.width - margin, p.x));
                p.y = Math.max(margin, Math.min(canvas.height - margin, p.y));
            });

            // Projectiles
            projectiles.forEach((p, pi) => {
                p.x += p.vx; p.y += p.vy; p.life--;
                if(p.life <= 0) projectiles.splice(pi, 1);
                enemies.forEach((e, ei) => {
                    if(Math.hypot(p.x - e.x, p.y - e.y) < 50) { killEnemy(e, ei, true); }
                });
            });

            // Enemies
            enemies.forEach((e, i) => {
                let target = null;
                let minDist = Infinity;
                players.forEach(p => {
                    if(!p.alive) return;
                    const d = Math.hypot(p.x - e.x, p.y - e.y);
                    if(d < minDist) { minDist = d; target = p; }
                });

                if(target) {
                    e.x += ((target.x - e.x)/minDist) * e.speed;
                    e.y += ((target.y - e.y)/minDist) * e.speed;
                }
                e.pulse += 0.15;

                players.forEach(p => {
                    if(!p.alive) return;
                    const dist = Math.hypot(p.x - e.x, p.y - e.y);
                    if (dist < 35) {
                        if (p.isDashing) killEnemy(e, i);
                        else {
                            p.health -= 1.2;
                            document.getElementById(`healthFill${p.id}`).style.width = (p.health / p.maxHealth * 100) + '%';
                            screenShake = 10;
                            if (p.health <= 0) { 
                                p.alive = false; 
                                if(!isTwoPlayer) endGame();
                                else if(players.every(pl => !pl.alive)) endGame();
                            }
                        }
                    }
                });
            });

            bloodSplats.forEach((b, i) => { b.life--; if (b.life <= 0) bloodSplats.splice(i, 1); });
            particles.forEach((p, i) => { p.x += p.vx; p.y += p.vy; p.life -= 0.02; if(p.life <= 0) particles.splice(i,1); });
        }

        function killEnemy(e, index, isFireball = false) {
            enemies.splice(index, 1);
            combo++; comboTimer = 120;
            score += 100 * (1 + combo * 0.1);
            document.getElementById('scoreDisplay').innerText = Math.floor(score);
            screenShake = isFireball ? 25 : 15 + combo; 
            hitStop = isFireball ? 2 : 4;
            playImpactSound('kill');
            bloodSplats.push({ x: e.x, y: e.y, size: isFireball ? 60 : 40, life: 300 });
            for(let j=0; j<(isFireball ? 20 : 10); j++) {
                particles.push({
                    x: e.x, y: e.y,
                    vx: (Math.random()-0.5)*25, vy: (Math.random()-0.5)*25,
                    life: 1, color: isFireball ? '#f97316' : '#ef4444'
                });
            }
        }

        function draw() {
            ctx.save();
            if (screenShake > 1) ctx.translate((Math.random()-0.5)*screenShake, (Math.random()-0.5)*screenShake);
            ctx.fillStyle = '#020617'; 
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Arkaplan efekti
            const gradient = ctx.createLinearGradient(0, 0, canvas.width, canvas.height);
            gradient.addColorStop(0, '#1e1b4b');
            gradient.addColorStop(1, '#020617');
            ctx.fillStyle = gradient;
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            bloodSplats.forEach(b => {
                ctx.globalAlpha = b.life / 300; 
                ctx.fillStyle = '#450a0a';
                ctx.beginPath(); 
                ctx.arc(b.x, b.y, b.size, 0, Math.PI*2); 
                ctx.fill();
            });
            ctx.globalAlpha = 1;

            projectiles.forEach(p => {
                ctx.fillStyle = '#fb923c'; 
                ctx.shadowBlur = 20; 
                ctx.shadowColor = '#f97316';
                ctx.beginPath(); 
                ctx.arc(p.x, p.y, p.radius, 0, Math.PI*2); 
                ctx.fill();
            });
            ctx.shadowBlur = 0;

            enemies.forEach(e => {
                ctx.save(); 
                ctx.translate(e.x, e.y);
                const s = 1 + Math.sin(e.pulse)*0.1; 
                ctx.scale(s,s);
                ctx.fillStyle = '#1e1b4b'; 
                ctx.shadowBlur = 15; 
                ctx.shadowColor = 'red';
                ctx.beginPath(); 
                ctx.roundRect(-16, -16, 32, 32, 4); 
                ctx.fill();
                ctx.fillStyle = '#ef4444'; 
                ctx.beginPath(); 
                ctx.arc(-8,-4,4,0,Math.PI*2); 
                ctx.fill(); 
                ctx.beginPath(); 
                ctx.arc(8,-4,4,0,Math.PI*2); 
                ctx.fill();
                ctx.restore();
            });

            players.forEach(p => {
                if(!p.alive) return;
                ctx.save();
                ctx.beginPath(); 
                ctx.lineWidth = 20; 
                ctx.lineCap = 'round'; 
                ctx.strokeStyle = p.id === 1 ? '#020617' : '#052c16';
                p.capeNodes[0] = {x: p.x, y: p.y};
                for(let i = 1; i < p.capeNodes.length; i++) {
                    const node = p.capeNodes[i], prev = p.capeNodes[i-1];
                    const angle = Math.atan2(prev.y-node.y, prev.x-node.x);
                    node.x = prev.x - Math.cos(angle)*6; 
                    node.y = prev.y - Math.sin(angle)*6;
                    ctx.lineWidth = 20 - i*2; 
                    ctx.lineTo(node.x, node.y);
                }
                ctx.stroke();
                ctx.save();
                ctx.translate(p.x, p.y); 
                ctx.rotate(p.angle);
                ctx.fillStyle = p.color; 
                ctx.beginPath(); 
                ctx.roundRect(-13,-16,26,32,4); 
                ctx.fill();
                ctx.fillStyle = '#fff'; 
                ctx.beginPath(); 
                ctx.moveTo(-8,-20); 
                ctx.lineTo(13,-24); 
                ctx.lineTo(24,-6); 
                ctx.lineTo(10,5); 
                ctx.fill();
                ctx.fillStyle = p.headColor; 
                ctx.beginPath(); 
                ctx.arc(10,0,14,0,Math.PI*2); 
                ctx.fill();
                ctx.fillStyle = '#ef4444'; 
                ctx.fillRect(16,-4,4,1.5); 
                ctx.fillRect(16,2,4,1.5);
                ctx.restore();
                ctx.restore();
            });

            // IÅŸÄ±k efekti
            let centerP = players.find(p => p.alive) || players[0];
            const grad = ctx.createRadialGradient(centerP.x, centerP.y, 60, centerP.x, centerP.y, 700);
            grad.addColorStop(0, 'rgba(0,0,0,0)'); 
            grad.addColorStop(1, 'rgba(2,6,23,0.9)');
            ctx.fillStyle = grad; 
            ctx.fillRect(0,0,canvas.width, canvas.height);
            
            particles.forEach(p => { 
                ctx.globalAlpha = p.life; 
                ctx.fillStyle = p.color; 
                ctx.fillRect(p.x, p.y, 4, 4); 
            });
            ctx.restore();
        }

        function endGame() {
            gameState = 'GAMEOVER';
            const earned = Math.floor(score / 10);
            totalGold += earned;
            updateCurrencyUI();
            screens.start.style.display = 'flex';
            screens.menuBtns.style.display = 'block';
            screens.select.style.display = 'none';
            document.getElementById('mainTitle').innerText = labels.gameOver;
            document.getElementById('mainTitle').style.color = '#ef4444';
            document.getElementById('tagline').innerText = `SKOR: ${Math.floor(score)} | +${earned}G`;
            document.getElementById('playBtn').innerText = labels.tryAgain;
            
            // Mobil kontrolleri gizle
            if(isMobile) {
                document.getElementById('joyBase').style.display = 'none';
                document.getElementById('actionButtons').style.display = 'none';
            }
        }

        function gameLoop() { 
            update(); 
            draw(); 
            requestAnimationFrame(gameLoop); 
        }

        // === MOBÄ°L INPUT (KLAVYE TAKLÄ°DÄ°) ===
        let joyActive = false;
        let joyCenter = {x:0,y:0};

        const joyBase = document.getElementById('joyBase');
        const joyStick = document.getElementById('joyStick');

        joyBase.addEventListener('touchstart', e=>{
            e.preventDefault();
            joyActive = true;
            const rect = joyBase.getBoundingClientRect();
            joyCenter = {
                x: rect.left + rect.width/2,
                y: rect.top + rect.height/2
            };
        }, {passive: false});

        joyBase.addEventListener('touchmove', e=>{
            e.preventDefault();
            if(!joyActive) return;
            const t = e.touches[0];
            let dx = t.clientX - joyCenter.x;
            let dy = t.clientY - joyCenter.y;
            const dist = Math.min(45, Math.hypot(dx,dy));
            const ang = Math.atan2(dy,dx);
            const x = Math.cos(ang)*dist;
            const y = Math.sin(ang)*dist;

            joyStick.style.transform = `translate(${x}px,${y}px)`;

            // Klavye taklidi
            keys['KeyW'] = keys['ArrowUp'] = y < -15;
            keys['KeyS'] = keys['ArrowDown'] = y > 15;
            keys['KeyA'] = keys['ArrowLeft'] = x < -15;
            keys['KeyD'] = keys['ArrowRight'] = x > 15;
        }, {passive: false});

        joyBase.addEventListener('touchend', (e)=>{
            e.preventDefault();
            joyActive = false;
            joyStick.style.transform = 'translate(0,0)';
            keys['KeyW']=keys['KeyS']=keys['KeyA']=keys['KeyD']=false;
            keys['ArrowUp']=keys['ArrowDown']=keys['ArrowLeft']=keys['ArrowRight']=false;
        }, {passive: false});

        /* DASH */
        document.getElementById('dashBtn').addEventListener('touchstart', (e)=>{
            e.preventDefault();
            keys['Space'] = true;
        }, {passive: false});
        
        document.getElementById('dashBtn').addEventListener('touchend', (e)=>{
            e.preventDefault();
            keys['Space'] = false;
        }, {passive: false});

        /* FIREBALL */
        document.getElementById('fireBtn').addEventListener('touchstart', (e)=>{
            e.preventDefault();
            keys['KeyF'] = true;
        }, {passive: false});
        
        document.getElementById('fireBtn').addEventListener('touchend', (e)=>{
            e.preventDefault();
            keys['KeyF'] = false;
        }, {passive: false});

        // Dokunmatik butonlar iÃ§in click event'leri
        document.getElementById('dashBtn').addEventListener('click', (e)=>{
            e.preventDefault();
        });
        
        document.getElementById('fireBtn').addEventListener('click', (e)=>{
            e.preventDefault();
        });

        // Klavye kontrolleri
        window.addEventListener('keydown', e => { 
            keys[e.code] = true; 
            if(e.code === 'Escape' && gameState === 'PLAYING') { 
                gameState = 'PAUSED'; 
                screens.pause.style.display = 'flex'; 
            } 
        });
        
        window.addEventListener('keyup', e => keys[e.code] = false);
        
        // UI Event Listeners
        document.getElementById('playBtn').onclick = () => { 
            screens.menuBtns.style.display = 'none'; 
            screens.select.style.display = 'flex'; 
        };
        
        document.getElementById('backToMainFromSelect').onclick = () => { 
            screens.select.style.display = 'none'; 
            screens.menuBtns.style.display = 'block'; 
        };
        
        document.getElementById('start1P').onclick = () => { 
            screens.start.style.display = 'none'; 
            gameState = 'PLAYING'; 
            initGame(false); 
        };
        
        document.getElementById('start2P').onclick = () => { 
            screens.start.style.display = 'none'; 
            gameState = 'PLAYING'; 
            initGame(true); 
        };
        
        document.getElementById('openShopBtn').onclick = () => { 
            screens.menuBtns.style.display = 'none'; 
            screens.shop.style.display = 'flex'; 
        };
        
        document.getElementById('closeShopBtn').onclick = () => { 
            screens.shop.style.display = 'none'; 
            screens.menuBtns.style.display = 'block'; 
        };
        
        document.getElementById('settingsBtn').onclick = () => { 
            screens.menuBtns.style.display = 'none'; 
            screens.settings.style.display = 'flex'; 
        };
        
        document.getElementById('backBtn').onclick = () => { 
            screens.settings.style.display = 'none'; 
            screens.menuBtns.style.display = 'block'; 
        };
        
        document.getElementById('resumeBtn').onclick = () => { 
            gameState = 'PLAYING'; 
            screens.pause.style.display = 'none'; 
        };
        
        document.getElementById('restartBtn').onclick = () => { 
            screens.pause.style.display = 'none'; 
            gameState = 'PLAYING'; 
            initGame(isTwoPlayer); 
        };

        // SatÄ±n alma butonlarÄ±
        document.getElementById('buyFireball').onclick = () => {
            if(totalGold >= 500) { 
                totalGold -= 500; 
                ownedFireballs++; 
                updateCurrencyUI(); 
                playImpactSound('fireball'); 
            }
        };
        
        document.getElementById('buyHealth').onclick = () => {
            if(totalGold >= 300) { 
                totalGold -= 300; 
                maxHealthBonus += 20; 
                updateCurrencyUI(); 
                playImpactSound('fireball'); 
            }
        };

        // Dil butonlarÄ±
        document.querySelectorAll('.lang-btn').forEach(btn => { 
            btn.onclick = () => setLanguage(btn.dataset.lang); 
        });

        // Sayfa yÃ¼klendiÄŸinde
        document.addEventListener('DOMContentLoaded', () => {
            updateCurrencyUI(); 
            setLanguage('tr');
            
            // Mobil cihazlarda kontrolleri gÃ¶ster
            if(isMobile) {
                console.log('Mobil cihaz algÄ±landÄ±, kontroller aktif');
            } else {
                console.log('MasaÃ¼stÃ¼ cihaz, kontroller gizli');
            }
            
            // Tam ekran butonu ekle (isteÄŸe baÄŸlÄ±)
            if(isMobile && document.documentElement.requestFullscreen) {
                const fullscreenBtn = document.createElement('button');
                fullscreenBtn.innerHTML = 'â›¶';
                fullscreenBtn.style.cssText = 'position:fixed;top:10px;right:10px;z-index:1000;background:#6366f1;color:white;border:none;width:40px;height:40px;border-radius:8px;font-size:20px;';
                fullscreenBtn.onclick = () => {
                    if(!document.fullscreenElement) {
                        document.documentElement.requestFullscreen();
                    } else {
                        document.exitFullscreen();
                    }
                };
                document.body.appendChild(fullscreenBtn);
            }
        });

        // Oyun dÃ¶ngÃ¼sÃ¼nÃ¼ baÅŸlat
        gameLoop();
    </script>
</body>
</html>
